# 第二阶段实施路线图

## 第1周：进程检测模块

### Day 1-2: 基础框架
- [ ] 更新 `Cargo.toml` 添加平台特定依赖
- [ ] 创建平台无关的trait接口
- [ ] 设置条件编译结构

### Day 3-4: Windows实现
- [ ] 实现进程枚举 (使用 `CreateToolhelp32Snapshot`)
- [ ] 实现版本检测
- [ ] 实现数据目录定位

### Day 5-6: macOS实现
- [ ] 实现进程枚举 (使用 `sysctl`)
- [ ] 实现版本检测 (读取 Info.plist)
- [ ] 实现数据目录定位

### Day 7: 测试和文档
- [ ] 编写单元测试
- [ ] 编写集成测试
- [ ] 更新API文档

## 第2周：密钥提取模块

### Day 8-9: 密钥提取框架
- [ ] 设计密钥存储结构
- [ ] 实现密钥验证逻辑
- [ ] 添加安全措施 (zeroize)

### Day 10-11: Windows密钥提取
- [ ] 实现内存读取 (`ReadProcessMemory`)
- [ ] 实现3.x版本密钥模式匹配
- [ ] 实现4.0版本密钥提取

### Day 12-13: macOS密钥提取
- [ ] 实现内存读取 (`vm_read`)
- [ ] 实现密钥搜索算法
- [ ] 处理SIP相关问题

### Day 14: 密钥管理
- [ ] 实现密钥缓存
- [ ] 实现密钥验证
- [ ] 安全性审查

## 第3周：数据解密模块

### Day 15-16: 解密算法实现
- [ ] 实现AES-128-CBC解密
- [ ] 实现自定义解密算法
- [ ] 性能优化

### Day 17-18: 数据库解密
- [ ] SQLite数据库解密
- [ ] 分页处理
- [ ] 错误恢复

### Day 19-20: 多媒体解密
- [ ] 图片解密 (.dat -> .jpg/.png)
- [ ] 语音解密 (SILK -> MP3)
- [ ] 视频解密

### Day 21: 集成和优化
- [ ] 批量处理实现
- [ ] 并发优化
- [ ] 进度显示

## 关键里程碑

1. **M1 (第1周末)**: 能够检测到微信进程并获取版本信息
2. **M2 (第2周末)**: 能够成功提取密钥
3. **M3 (第3周末)**: 能够解密数据文件

## 技术债务跟踪

- [ ] 添加更多的错误处理
- [ ] 改进日志记录
- [ ] 性能基准测试
- [ ] 安全审计

## 下一步行动

1. 切换到Code模式
2. 开始实现进程检测模块
3. 从Windows平台开始（因为用户量更大）

## 成功标准

- ✅ 所有测试通过
- ✅ 支持Windows 10/11
- ✅ 支持macOS 12+
- ✅ 支持微信3.x和4.0版本
- ✅ 解密成功率 > 95%
- ✅ 性能：100MB文件解密 < 1秒

## 风险缓解

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 微信更新改变数据格式 | 高 | 建立版本兼容性测试 |
| 权限问题 | 中 | 提供详细的权限指南 |
| 性能问题 | 中 | 实现并发和缓存 |
| 安全漏洞 | 高 | 代码审查和安全测试 |

## 资源需求

- Windows开发环境
- macOS开发环境
- 不同版本的微信测试环境
- 测试数据集

## 准备切换到实现阶段

现在我们已经有了：
1. 详细的实施计划
2. 清晰的架构设计
3. 具体的实施路线图

建议接下来：
1. 切换到Code模式
2. 开始实现进程检测模块
3. 遵循测试驱动开发(TDD)方法